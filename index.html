<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì´ˆëŠ¥ë ¥ ìœ·ë†€ì´</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap');
*{font-family:'Noto Sans KR',sans-serif;box-sizing:border-box;margin:0;padding:0}
body{background:#1a1225;color:#fff;min-height:100vh;overflow-x:hidden}
#fx-overlay{position:fixed;inset:0;pointer-events:none;z-index:100;display:flex;align-items:center;justify-content:center}
.fx-banner{font-size:48px;font-weight:900;text-shadow:0 0 30px rgba(255,210,63,.8),0 0 60px rgba(255,107,53,.5);animation:fx-pop .8s ease-out forwards;opacity:0;transform:scale(0)}
@keyframes fx-pop{0%{opacity:0;transform:scale(0) rotate(-5deg)}40%{opacity:1;transform:scale(1.3) rotate(2deg)}100%{opacity:0;transform:scale(1) rotate(0)translateY(-30px)}}
.fx-shake{animation:shake .4s ease-in-out}
@keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-4px)}80%{transform:translateX(4px)}}
.fx-glow-yut{box-shadow:0 0 40px rgba(255,210,63,.6),0 0 80px rgba(255,210,63,.3)!important;border-color:#ffd23f!important}
.timer-bg{background:linear-gradient(90deg,#0f172a,#1e293b);height:10px;border-radius:5px;overflow:hidden;border:1px solid #334155}
.timer-fill{height:100%;border-radius:5px;transition:width .1s linear}
.timer-safe .timer-fill{background:linear-gradient(90deg,#22c55e,#10b981)}
.timer-warn .timer-fill{background:linear-gradient(90deg,#f59e0b,#ef4444)}
.timer-danger .timer-fill{background:linear-gradient(90deg,#ef4444,#dc2626);animation:timer-pulse .5s infinite}
@keyframes timer-pulse{0%,100%{opacity:1}50%{opacity:.6}}
.board-wrap{position:relative;width:320px;height:320px;margin:0 auto;background:radial-gradient(circle at 50% 50%,rgba(139,92,42,.15) 0%,transparent 70%)}
.yut-node{position:absolute;width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;transform:translate(-50%,-50%);transition:all .2s;z-index:2;cursor:default}
.yut-node.corner{width:38px;height:38px;font-size:10px}
.yut-node.node-start{background:#4a3728;border:2px solid #d4a853;color:#ffd23f;font-size:8px}
.yut-node.node-corner{background:#3d2d1e;border:2px solid #8b6914;color:#d4a853}
.yut-node.node-center{background:#5a3a1e;border:2px solid #ffa500;color:#ffcc66}
.yut-node.node-normal{background:#2a2035;border:1.5px solid #4a3d5a;color:#8b7fa0}
.pm{position:absolute;border-radius:50%;border:2px solid #fff;z-index:10;transform:translate(-50%,-50%);transition:all .4s ease-out;display:flex;align-items:center;justify-content:center;font-size:8px;font-weight:900;color:#fff;cursor:default}
.pm-my{background:linear-gradient(135deg,#6366f1,#818cf8);width:16px;height:16px}
.pm-opp{background:linear-gradient(135deg,#ef4444,#f87171);width:16px;height:16px}
.pm-stacked{width:20px;height:20px;box-shadow:0 0 8px rgba(255,255,255,.5)}
@keyframes target-pulse{0%,100%{box-shadow:0 0 0 0 rgba(250,204,21,.5)}50%{box-shadow:0 0 0 8px rgba(250,204,21,0)}}
.board-icon{position:absolute;z-index:5;font-size:14px;transform:translate(-50%,-50%);pointer-events:none;filter:drop-shadow(0 0 4px rgba(0,0,0,.8))}
.skill-card{transition:all .2s;position:relative;overflow:hidden}
.skill-card::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,255,255,.1),transparent);pointer-events:none}
.skill-card:not(:disabled):hover{transform:translateY(-3px);filter:brightness(1.2)}
.skill-card.active{animation:skill-glow 1s infinite}
@keyframes skill-glow{0%,100%{box-shadow:0 0 0 0 rgba(250,204,21,.5)}50%{box-shadow:0 0 0 10px rgba(250,204,21,0)}}
.skill-card.used{filter:grayscale(1) brightness(.4)}
.piece-btn{transition:all .15s}
.piece-btn.selectable{animation:piece-pulse .8s infinite;cursor:pointer}
@keyframes piece-pulse{0%,100%{box-shadow:0 0 0 0 rgba(250,204,21,.4)}50%{box-shadow:0 0 0 6px rgba(250,204,21,0)}}
.target-mode .pm-opp.targetable,.target-mode .pm-my.targetable{animation:target-pulse 1s infinite;cursor:pointer}
#target-banner{display:none}
.target-mode #target-banner{display:block}
.result-box{min-height:52px;display:flex;align-items:center;justify-content:center}
.yut-result-text{font-weight:900;font-size:28px}
.yut-result-text.big{font-size:36px;text-shadow:0 0 20px currentColor}
.event-toast{position:fixed;top:20%;left:50%;transform:translateX(-50%);z-index:90;padding:10px 24px;border-radius:12px;font-weight:700;font-size:16px;background:rgba(20,10,30,.9);border:2px solid rgba(255,210,63,.5);color:#ffd23f;text-shadow:0 0 10px rgba(255,210,63,.5);animation:toast-in .4s ease-out;pointer-events:none}
@keyframes toast-in{0%{opacity:0;transform:translateX(-50%) translateY(20px) scale(.8)}100%{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}}

/* ì±„íŒ… */
#chat-toggle{position:fixed;bottom:16px;right:16px;z-index:50;width:48px;height:48px;border-radius:50%;border:none;
  background:linear-gradient(135deg,#6366f1,#818cf8);color:#fff;font-size:20px;cursor:pointer;
  box-shadow:0 4px 12px rgba(99,102,241,.5);transition:all .2s}
#chat-toggle:hover{transform:scale(1.1)}
#chat-badge{position:absolute;top:-4px;right:-4px;width:20px;height:20px;border-radius:50%;
  background:#ef4444;color:#fff;font-size:10px;font-weight:900;display:none;
  align-items:center;justify-content:center;border:2px solid #1a1225;animation:badge-pop .3s ease-out}
@keyframes badge-pop{0%{transform:scale(0)}50%{transform:scale(1.3)}100%{transform:scale(1)}}
#chat-panel{position:fixed;bottom:72px;right:16px;z-index:50;width:300px;max-height:400px;
  border-radius:16px;overflow:hidden;display:none;flex-direction:column;
  background:#1e1530;border:1px solid #3a2d4a;box-shadow:0 8px 32px rgba(0,0,0,.5)}
#chat-panel.open{display:flex}
#chat-header{padding:10px 14px;font-size:12px;font-weight:700;color:#d4a853;
  border-bottom:1px solid #3a2d4a;display:flex;align-items:center;justify-content:space-between}
#chat-msgs{flex:1;overflow-y:auto;padding:8px;min-height:200px;max-height:280px}
.chat-msg{margin-bottom:6px;padding:6px 10px;border-radius:10px;font-size:12px;max-width:85%;word-break:break-word}
.chat-msg.me{background:rgba(99,102,241,.2);color:#c4b5fd;margin-left:auto;border-bottom-right-radius:4px}
.chat-msg.opp{background:rgba(255,255,255,.06);color:#d1d5db;margin-right:auto;border-bottom-left-radius:4px}
.chat-msg.sys{background:transparent;color:#6b7280;font-size:10px;text-align:center;max-width:100%;margin:4px auto}
#chat-form{display:flex;gap:6px;padding:8px;border-top:1px solid #3a2d4a}
#chat-input{flex:1;padding:8px 12px;border-radius:10px;border:1px solid #3a2d4a;background:#140e1e;color:#fff;font-size:12px;outline:none}
#chat-input:focus{border-color:#6366f1}
#chat-send{padding:8px 14px;border-radius:10px;border:none;background:#6366f1;color:#fff;font-size:12px;font-weight:700;cursor:pointer}
#chat-send:hover{background:#818cf8}
</style>
</head>
<body>
<div id="app" class="max-w-lg mx-auto p-3">
  <div class="text-center py-2">
    <h1 class="text-2xl font-black" style="color:#d4a853">ì´ˆëŠ¥ë ¥ ìœ·ë†€ì´</h1>
    <div class="text-xs text-gray-500" id="room-info"></div>
  </div>

  <!-- ë¡œë¹„ -->
  <div id="lobby">
    <div class="mb-3 p-3 rounded-xl text-center text-sm" style="background:#1e1530;border:1px solid #3a2d4a">
      <span id="status-msg" class="text-gray-400 animate-pulse">ì ‘ì† ì¤‘...</span>
    </div>
    <button id="find-btn" class="hidden w-full py-3 rounded-xl font-bold text-lg transition-all"
      style="background:linear-gradient(135deg,#6366f1,#818cf8);color:#fff">ğŸ” ëŒ€ì „ ì°¾ê¸°</button>
  </div>

  <!-- ê²Œì„ -->
  <div id="game" class="hidden">
    <div class="mb-2 flex items-center justify-between text-xs">
      <div class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-indigo-500 inline-block"></span><span id="p1-name" class="text-indigo-300">P1</span></div>
      <span class="text-gray-600">VS</span>
      <div class="flex items-center gap-1"><span id="p2-name" class="text-red-300">P2</span><span class="w-3 h-3 rounded-full bg-red-500 inline-block"></span></div>
    </div>
    <div id="timer-wrap" class="hidden mb-3 timer-safe">
      <div class="timer-bg"><div id="timer-bar" class="timer-fill" style="width:100%"></div></div>
      <div class="flex justify-between text-xs mt-1"><span class="text-gray-500">â±</span><span id="timer-text" class="text-emerald-400 font-bold">15</span></div>
    </div>
    <div class="mb-2 p-2 rounded-xl text-center text-sm" style="background:#1e1530;border:1px solid #3a2d4a">
      <span id="game-status-msg" class="text-gray-400">â€”</span>
    </div>
    <div id="result-box" class="result-box mb-2 p-2 rounded-xl" style="background:#1e1530;border:1px solid #3a2d4a">
      <span class="text-gray-500">ğŸ² ëŒ€ê¸° ì¤‘</span>
    </div>
    <button id="roll-btn" class="w-full py-3 rounded-xl font-bold text-lg transition-all mb-3 disabled:opacity-40 disabled:cursor-not-allowed"
      style="background:linear-gradient(135deg,#d4a853,#b8860b);color:#1a1225;box-shadow:0 4px 0 #8b6914" disabled>ğŸ² ìœ· ë˜ì§€ê¸°!</button>
    <div class="mb-3">
      <div class="text-xs text-gray-500 mb-1">âš¡ ì´ˆëŠ¥ë ¥</div>
      <div id="skills-area" class="flex gap-2"></div>
    </div>
    <div id="target-banner" class="mb-3 p-2 rounded-xl text-center text-sm font-bold animate-pulse" style="background:rgba(250,204,21,.1);border:1px solid rgba(250,204,21,.3);color:#ffd23f">
      ğŸ‘† ëŒ€ìƒ ì„ íƒ Â· <button id="cancel-target" class="underline text-xs opacity-70">ì·¨ì†Œ</button>
    </div>
    <div class="rounded-xl p-2 mb-3" style="background:#1e1530;border:1px solid #3a2d4a">
      <div id="board" class="board-wrap"><svg id="board-svg" width="320" height="320" class="absolute inset-0" style="z-index:1"></svg></div>
    </div>
    <div class="grid grid-cols-2 gap-3 mb-3">
      <div class="p-3 rounded-xl" style="background:rgba(99,102,241,.1);border:1px solid rgba(99,102,241,.3)">
        <div class="text-xs font-bold text-indigo-300 mb-2">ğŸŸ¦ ë‚˜ì˜ ë§</div>
        <div id="my-pcs" class="grid grid-cols-2 gap-1.5"></div>
      </div>
      <div class="p-3 rounded-xl" style="background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3)">
        <div class="text-xs font-bold text-red-300 mb-2">ğŸŸ¥ ìƒëŒ€ ë§</div>
        <div id="opp-pcs" class="grid grid-cols-2 gap-1.5"></div>
      </div>
    </div>
    <button id="back-lobby-btn" class="hidden w-full py-2 rounded-xl text-sm font-bold text-gray-400 hover:text-white" style="background:#1e1530;border:1px solid #3a2d4a">ğŸ  ë¡œë¹„ë¡œ ëŒì•„ê°€ê¸°</button>
  </div>
</div>

<!-- ì±„íŒ… í† ê¸€ -->
<button id="chat-toggle" class="hidden">ğŸ’¬<span id="chat-badge"></span></button>

<!-- ì±„íŒ… íŒ¨ë„ -->
<div id="chat-panel">
  <div id="chat-header"><span>ğŸ’¬ ì±„íŒ…</span><button id="chat-close" style="background:none;border:none;color:#6b7280;cursor:pointer;font-size:16px">âœ•</button></div>
  <div id="chat-msgs"></div>
  <div id="chat-form">
    <input id="chat-input" type="text" maxlength="100" placeholder="ë©”ì‹œì§€ ì…ë ¥...">
    <button id="chat-send">ì „ì†¡</button>
  </div>
</div>

<div id="fx-overlay"></div>
<script type="module" src="app.js"></script>
</body>
</html>
